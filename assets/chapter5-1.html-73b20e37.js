import{_ as s,r as i,o as l,c as d,a as e,b as n,d as a,e as c}from"./app-25465c35.js";const o={},r=e("h1",{id:"fc游戏机手柄",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#fc游戏机手柄","aria-hidden":"true"},"#"),n(" FC游戏机手柄")],-1),p={href:"https://item.taobao.com/item.htm?id=683875901407",target:"_blank",rel:"noopener noreferrer"},h=e("h2",{id:"硬件准备",tabindex:"-1"},[e("a",{class:"header-anchor",href:"#硬件准备","aria-hidden":"true"},"#"),n(" 硬件准备")],-1),u={href:"https://item.taobao.com/item.htm?id=683875901407",target:"_blank",rel:"noopener noreferrer"},_={href:"https://item.taobao.com/item.htm?id=683875901407",target:"_blank",rel:"noopener noreferrer"},m=c(`<p>FC手柄有10个按键（实际上只有8个）：</p><p>上、下、左、右、Start、Select、A、B、A连发、B连发。</p><p>A和A连发是一个键值，而B和B连发也是一个键值，只是连发按键当你一直按下的时候，会不停的发送（方便快速按键，比如发炮弹之类的功能）。</p><p>FC手柄的控制电路，由1个8位并入串出的移位寄存器，外加一个时基集成电路（用于连发）构成。读取手柄按键值的信息十分简单：先Latch（锁存键值），然后就得到了第一个按键值（A，下降沿采集），之后在7个Clock的作用下，依次读取其他按键的键值，总共8个按键键值。</p><h3 id="接线" tabindex="-1"><a class="header-anchor" href="#接线" aria-hidden="true">#</a> 接线</h3><table><thead><tr><th style="text-align:left;">Micro USB引脚</th><th style="text-align:left;">FC游戏机手柄芯片引脚</th><th style="text-align:left;">Mio 引脚</th></tr></thead><tbody><tr><td style="text-align:left;">VCC</td><td style="text-align:left;">VCC</td><td style="text-align:left;">3.3v/5v</td></tr><tr><td style="text-align:left;">GND</td><td style="text-align:left;">GND</td><td style="text-align:left;">GND</td></tr><tr><td style="text-align:left;">ID</td><td style="text-align:left;">CLOCK</td><td style="text-align:left;">40</td></tr><tr><td style="text-align:left;">D+</td><td style="text-align:left;">LATCH</td><td style="text-align:left;">41</td></tr><tr><td style="text-align:left;">D-</td><td style="text-align:left;">DATA</td><td style="text-align:left;">42</td></tr></tbody></table><h3 id="fc游戏机手柄时序图" tabindex="-1"><a class="header-anchor" href="#fc游戏机手柄时序图" aria-hidden="true">#</a> FC游戏机手柄时序图</h3><p>每给一个脉冲，就输出一位数据(按下是1，松开是0.)，输出顺序: A-&gt;B-&gt;SELECT-&gt;START-&gt;UP-&gt;DOWN-&gt;LEFT-&gt;RIGHT.</p><p><img src="https://photos.100ask.net/esp32-docs/DShanMCU-Mio/ESP-IDF/chapter5/DShanMCU-Mio_esp-idf_chapter5-1_images_001.jpg" alt="DShanMCU-Mio_esp-idf_chapter5-1_images_001"></p><h2 id="软件准备" tabindex="-1"><a class="header-anchor" href="#软件准备" aria-hidden="true">#</a> 软件准备</h2><p>本次实验的项目代码位于： <code>DShanMCU-Mio_ESP-IDF_Data\\02_examples\\esp-idf-learn\\03_controller\\fc_joypad\\00_fc_joypad_simple_test</code> 。</p><blockquote><p>注意，不要将项目代码移动到其他地方，否则编译会报错。后续实验也请保持原有的目录结构进行学习，不要移动项目代码的位置。</p></blockquote><h2 id="打开项目工程" tabindex="-1"><a class="header-anchor" href="#打开项目工程" aria-hidden="true">#</a> 打开项目工程</h2><p>通过 vscode 或 终端控制台打开项目工程目录，以便进行后续操作。</p><h2 id="关键代码解读" tabindex="-1"><a class="header-anchor" href="#关键代码解读" aria-hidden="true">#</a> 关键代码解读</h2><p>FC游戏机手柄的驱动库位于： <code>DShanMCU-Mio_ESP-IDF_Data\\02_examples\\esp-idf-learn\\00_components\\esp-idf-components\\fc_joypad_100ask_drivers</code></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code>
<span class="token comment">// 初始化 fc_joypad</span>
<span class="token function">fc_joypad_100ask_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 更新按键状态(每次耗时： x*16(ms)，x的值请进入到该函数确定，默认为5)，更新间隔不可太长，因为会影响体验；也不可没有延时，因为会导致其他任务无法正常执行</span>
<span class="token function">fc_joypad_100ask_read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 获取当前的按键状态： 是否有按键被按下(pressed)，否则全部按键都是 松开(release) 状态</span>
<span class="token function">fc_joypad_100ask_state</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查某按键是否为按下状态</span>
<span class="token function">fc_joypad_100ask_is_pressed</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 检查某按键是否为松开状态</span>
<span class="token function">fc_joypad_100ask_is_release</span><span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">;</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="运行现象" tabindex="-1"><a class="header-anchor" href="#运行现象" aria-hidden="true">#</a> 运行现象</h2><p>直接点击编译即可，烧写到开发板之后，打开串口(波特率 115200)，然后按下手柄上的按钮，即可看到输出信息和按键状态一致。</p><h2 id="修改默认的配置" tabindex="-1"><a class="header-anchor" href="#修改默认的配置" aria-hidden="true">#</a> 修改默认的配置</h2><p>打开 menuconfig，进入到下面所示的路径进行配置：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>
<span class="token punctuation">(</span>Top<span class="token punctuation">)</span> 
    → Component config 
        → 100ask components 
            → 100ASK FC joypad setting
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,22);function f(v,b){const t=i("ExternalLinkIcon");return l(),d("div",null,[r,e("p",null,[n("此章节讲述使用 "),e("strong",null,[e("a",p,[n("FC游戏机手柄"),a(t)])]),n(" 的按键控制方式。")]),h,e("ul",null,[e("li",null,[e("a",u,[n("FC游戏机手柄"),a(t)]),n(" * 1")]),e("li",null,[e("a",_,[n("Micro USB模块"),a(t)]),n(" * 1")])]),m])}const g=s(o,[["render",f],["__file","chapter5-1.html.vue"]]);export{g as default};
